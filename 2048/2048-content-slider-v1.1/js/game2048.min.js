!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).Game2048=t()}}(function(){return function r(o,a,h){function u(e,t){if(!a[e]){if(!o[e]){var i="function"==typeof require&&require;if(!t&&i)return i(e,!0);if(c)return c(e,!0);var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}var s=a[e]={exports:{}};o[e][0].call(s.exports,function(t){return u(o[e][1][t]||t)},s,s.exports,r,o,a,h)}return a[e].exports}for(var c="function"==typeof require&&require,t=0;t<h.length;t++)u(h[t]);return u}({1:[function(t,Kt,e){!function(r,s,t,l){"use strict";var o,a=["","webkit","Moz","MS","ms","o"],e=s.createElement("div"),i="function",h=Math.round,p=Math.abs,d=Date.now;function u(t,e,i){return setTimeout(y(t,i),e)}function n(t,e,i){return!!Array.isArray(t)&&(c(t,i[e],i),!0)}function c(t,e,i){var n;if(t)if(t.forEach)t.forEach(e,i);else if(t.length!==l)for(n=0;n<t.length;)e.call(i,t[n],n,t),n++;else for(n in t)t.hasOwnProperty(n)&&e.call(i,t[n],n,t)}function f(n,t,e){var s="DEPRECATED METHOD: "+t+"\n"+e+" AT \n";return function(){var t=new Error("get-stack-trace"),e=t&&t.stack?t.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",i=r.console&&(r.console.warn||r.console.log);return i&&i.call(r.console,s,e),n.apply(this,arguments)}}o="function"!=typeof Object.assign?function(t){if(t===l||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),i=1;i<arguments.length;i++){var n=arguments[i];if(n!==l&&null!==n)for(var s in n)n.hasOwnProperty(s)&&(e[s]=n[s])}return e}:Object.assign;var m=f(function(t,e,i){for(var n=Object.keys(e),s=0;s<n.length;)(!i||i&&t[n[s]]===l)&&(t[n[s]]=e[n[s]]),s++;return t},"extend","Use `assign`."),v=f(function(t,e){return m(t,e,!0)},"merge","Use `assign`.");function g(t,e,i){var n,s=e.prototype;(n=t.prototype=Object.create(s)).constructor=t,n._super=s,i&&o(n,i)}function y(t,e){return function(){return t.apply(e,arguments)}}function T(t,e){return typeof t==i?t.apply(e&&e[0]||l,e):t}function w(t,e){return t===l?e:t}function E(e,t,i){c(S(t),function(t){e.addEventListener(t,i,!1)})}function C(e,t,i){c(S(t),function(t){e.removeEventListener(t,i,!1)})}function b(t,e){for(;t;){if(t==e)return!0;t=t.parentNode}return!1}function x(t,e){return-1<t.indexOf(e)}function S(t){return t.trim().split(/\s+/g)}function A(t,e,i){if(t.indexOf&&!i)return t.indexOf(e);for(var n=0;n<t.length;){if(i&&t[n][i]==e||!i&&t[n]===e)return n;n++}return-1}function I(t){return Array.prototype.slice.call(t,0)}function P(t,i,e){for(var n=[],s=[],r=0;r<t.length;){var o=i?t[r][i]:t[r];A(s,o)<0&&n.push(t[r]),s[r]=o,r++}return e&&(n=i?n.sort(function(t,e){return t[i]>e[i]}):n.sort()),n}function _(t,e){for(var i,n,s=e[0].toUpperCase()+e.slice(1),r=0;r<a.length;){if((n=(i=a[r])?i+s:e)in t)return n;r++}return l}var M=1;function z(t){var e=t.ownerDocument||t;return e.defaultView||e.parentWindow||r}var L="ontouchstart"in r,R=_(r,"PointerEvent")!==l,D=L&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),N="touch",O="mouse",k=25,G=1,F=4,Y=8,B=1,H=2,q=4,X=8,W=16,K=H|q,j=X|W,V=K|j,U=["x","y"],Z=["clientX","clientY"];function J(e,t){var i=this;this.manager=e,this.callback=t,this.element=e.element,this.target=e.options.inputTarget,this.domHandler=function(t){T(e.options.enable,[e])&&i.handler(t)},this.init()}function $(t,e,i){var n=i.pointers.length,s=i.changedPointers.length,r=e&G&&n-s==0,o=e&(F|Y)&&n-s==0;i.isFirst=!!r,i.isFinal=!!o,r&&(t.session={}),i.eventType=e,function(t,e){var i=t.session,n=e.pointers,s=n.length;i.firstInput||(i.firstInput=Q(e));1<s&&!i.firstMultiple?i.firstMultiple=Q(e):1===s&&(i.firstMultiple=!1);var r=i.firstInput,o=i.firstMultiple,a=o?o.center:r.center,h=e.center=tt(n);e.timeStamp=d(),e.deltaTime=e.timeStamp-r.timeStamp,e.angle=st(a,h),e.distance=nt(a,h),function(t,e){var i=e.center,n=t.offsetDelta||{},s=t.prevDelta||{},r=t.prevInput||{};e.eventType!==G&&r.eventType!==F||(s=t.prevDelta={x:r.deltaX||0,y:r.deltaY||0},n=t.offsetDelta={x:i.x,y:i.y});e.deltaX=s.x+(i.x-n.x),e.deltaY=s.y+(i.y-n.y)}(i,e),e.offsetDirection=it(e.deltaX,e.deltaY);var u=et(e.deltaTime,e.deltaX,e.deltaY);e.overallVelocityX=u.x,e.overallVelocityY=u.y,e.overallVelocity=p(u.x)>p(u.y)?u.x:u.y,e.scale=o?function(t,e){return nt(e[0],e[1],Z)/nt(t[0],t[1],Z)}(o.pointers,n):1,e.rotation=o?function(t,e){return st(e[1],e[0],Z)+st(t[1],t[0],Z)}(o.pointers,n):0,e.maxPointers=i.prevInput?e.pointers.length>i.prevInput.maxPointers?e.pointers.length:i.prevInput.maxPointers:e.pointers.length,function(t,e){var i,n,s,r,o=t.lastInterval||e,a=e.timeStamp-o.timeStamp;if(e.eventType!=Y&&(k<a||o.velocity===l)){var h=e.deltaX-o.deltaX,u=e.deltaY-o.deltaY,c=et(a,h,u);n=c.x,s=c.y,i=p(c.x)>p(c.y)?c.x:c.y,r=it(h,u),t.lastInterval=e}else i=o.velocity,n=o.velocityX,s=o.velocityY,r=o.direction;e.velocity=i,e.velocityX=n,e.velocityY=s,e.direction=r}(i,e);var c=t.element;b(e.srcEvent.target,c)&&(c=e.srcEvent.target);e.target=c}(t,i),t.emit("hammer.input",i),t.recognize(i),t.session.prevInput=i}function Q(t){for(var e=[],i=0;i<t.pointers.length;)e[i]={clientX:h(t.pointers[i].clientX),clientY:h(t.pointers[i].clientY)},i++;return{timeStamp:d(),pointers:e,center:tt(e),deltaX:t.deltaX,deltaY:t.deltaY}}function tt(t){var e=t.length;if(1===e)return{x:h(t[0].clientX),y:h(t[0].clientY)};for(var i=0,n=0,s=0;s<e;)i+=t[s].clientX,n+=t[s].clientY,s++;return{x:h(i/e),y:h(n/e)}}function et(t,e,i){return{x:e/t||0,y:i/t||0}}function it(t,e){return t===e?B:p(t)>=p(e)?t<0?H:q:e<0?X:W}function nt(t,e,i){var n=e[(i=i||U)[0]]-t[i[0]],s=e[i[1]]-t[i[1]];return Math.sqrt(n*n+s*s)}function st(t,e,i){var n=e[(i=i||U)[0]]-t[i[0]],s=e[i[1]]-t[i[1]];return 180*Math.atan2(s,n)/Math.PI}J.prototype={handler:function(){},init:function(){this.evEl&&E(this.element,this.evEl,this.domHandler),this.evTarget&&E(this.target,this.evTarget,this.domHandler),this.evWin&&E(z(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&C(this.element,this.evEl,this.domHandler),this.evTarget&&C(this.target,this.evTarget,this.domHandler),this.evWin&&C(z(this.element),this.evWin,this.domHandler)}};var rt={mousedown:G,mousemove:2,mouseup:F},ot="mousedown",at="mousemove mouseup";function ht(){this.evEl=ot,this.evWin=at,this.pressed=!1,J.apply(this,arguments)}g(ht,J,{handler:function(t){var e=rt[t.type];e&G&&0===t.button&&(this.pressed=!0),2&e&&1!==t.which&&(e=F),this.pressed&&(e&F&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:O,srcEvent:t}))}});var ut={pointerdown:G,pointermove:2,pointerup:F,pointercancel:Y,pointerout:Y},ct={2:N,3:"pen",4:O,5:"kinect"},lt="pointerdown",pt="pointermove pointerup pointercancel";function dt(){this.evEl=lt,this.evWin=pt,J.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}r.MSPointerEvent&&!r.PointerEvent&&(lt="MSPointerDown",pt="MSPointerMove MSPointerUp MSPointerCancel"),g(dt,J,{handler:function(t){var e=this.store,i=!1,n=t.type.toLowerCase().replace("ms",""),s=ut[n],r=ct[t.pointerType]||t.pointerType,o=r==N,a=A(e,t.pointerId,"pointerId");s&G&&(0===t.button||o)?a<0&&(e.push(t),a=e.length-1):s&(F|Y)&&(i=!0),a<0||(e[a]=t,this.callback(this.manager,s,{pointers:e,changedPointers:[t],pointerType:r,srcEvent:t}),i&&e.splice(a,1))}});var ft={touchstart:G,touchmove:2,touchend:F,touchcancel:Y};function mt(){this.evTarget="touchstart",this.evWin="touchstart touchmove touchend touchcancel",this.started=!1,J.apply(this,arguments)}g(mt,J,{handler:function(t){var e=ft[t.type];if(e===G&&(this.started=!0),this.started){var i=function(t,e){var i=I(t.touches),n=I(t.changedTouches);e&(F|Y)&&(i=P(i.concat(n),"identifier",!0));return[i,n]}.call(this,t,e);e&(F|Y)&&i[0].length-i[1].length==0&&(this.started=!1),this.callback(this.manager,e,{pointers:i[0],changedPointers:i[1],pointerType:N,srcEvent:t})}}});var vt={touchstart:G,touchmove:2,touchend:F,touchcancel:Y},gt="touchstart touchmove touchend touchcancel";function yt(){this.evTarget=gt,this.targetIds={},J.apply(this,arguments)}g(yt,J,{handler:function(t){var e=vt[t.type],i=function(t,e){var i=I(t.touches),n=this.targetIds;if(e&(2|G)&&1===i.length)return n[i[0].identifier]=!0,[i,i];var s,r,o=I(t.changedTouches),a=[],h=this.target;if(r=i.filter(function(t){return b(t.target,h)}),e===G)for(s=0;s<r.length;)n[r[s].identifier]=!0,s++;s=0;for(;s<o.length;)n[o[s].identifier]&&a.push(o[s]),e&(F|Y)&&delete n[o[s].identifier],s++;return a.length?[P(r.concat(a),"identifier",!0),a]:void 0}.call(this,t,e);i&&this.callback(this.manager,e,{pointers:i[0],changedPointers:i[1],pointerType:N,srcEvent:t})}});var Tt=2500;function wt(){J.apply(this,arguments);var t=y(this.handler,this);this.touch=new yt(this.manager,t),this.mouse=new ht(this.manager,t),this.primaryTouch=null,this.lastTouches=[]}function Et(t){var e=t.changedPointers[0];if(e.identifier===this.primaryTouch){var i={x:e.clientX,y:e.clientY};this.lastTouches.push(i);var n=this.lastTouches;setTimeout(function(){var t=n.indexOf(i);-1<t&&n.splice(t,1)},Tt)}}g(wt,J,{handler:function(t,e,i){var n=i.pointerType==N,s=i.pointerType==O;if(!(s&&i.sourceCapabilities&&i.sourceCapabilities.firesTouchEvents)){if(n)(function(t,e){t&G?(this.primaryTouch=e.changedPointers[0].identifier,Et.call(this,e)):t&(F|Y)&&Et.call(this,e)}).call(this,e,i);else if(s&&function(t){for(var e=t.srcEvent.clientX,i=t.srcEvent.clientY,n=0;n<this.lastTouches.length;n++){var s=this.lastTouches[n],r=Math.abs(e-s.x),o=Math.abs(i-s.y);if(r<=25&&o<=25)return!0}return!1}.call(this,i))return;this.callback(t,e,i)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var Ct=_(e.style,"touchAction"),bt=Ct!==l,xt="compute",St="manipulation",At="none",It="pan-x",Pt="pan-y",_t=function(){if(!bt)return!1;var e={},i=r.CSS&&r.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(t){e[t]=!i||r.CSS.supports("touch-action",t)}),e}();function Mt(t,e){this.manager=t,this.set(e)}Mt.prototype={set:function(t){t==xt&&(t=this.compute()),bt&&this.manager.element.style&&_t[t]&&(this.manager.element.style[Ct]=t),this.actions=t.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var e=[];return c(this.manager.recognizers,function(t){T(t.options.enable,[t])&&(e=e.concat(t.getTouchAction()))}),function(t){if(x(t,At))return At;var e=x(t,It),i=x(t,Pt);if(e&&i)return At;if(e||i)return e?It:Pt;if(x(t,St))return St;return"auto"}(e.join(" "))},preventDefaults:function(t){var e=t.srcEvent,i=t.offsetDirection;if(this.manager.session.prevented)e.preventDefault();else{var n=this.actions,s=x(n,At)&&!_t[At],r=x(n,Pt)&&!_t[Pt],o=x(n,It)&&!_t[It];if(s){var a=1===t.pointers.length,h=t.distance<2,u=t.deltaTime<250;if(a&&h&&u)return}if(!o||!r)return s||r&&i&K||o&&i&j?this.preventSrc(e):void 0}},preventSrc:function(t){this.manager.session.prevented=!0,t.preventDefault()}};var zt=1;function Lt(t){this.options=o({},this.defaults,t||{}),this.id=M++,this.manager=null,this.options.enable=w(this.options.enable,!0),this.state=zt,this.simultaneous={},this.requireFail=[]}function Rt(t){return 16&t?"cancel":8&t?"end":4&t?"move":2&t?"start":""}function Dt(t){return t==W?"down":t==X?"up":t==H?"left":t==q?"right":""}function Nt(t,e){var i=e.manager;return i?i.get(t):t}function Ot(){Lt.apply(this,arguments)}function kt(){Ot.apply(this,arguments),this.pX=null,this.pY=null}function Gt(){Ot.apply(this,arguments)}function Ft(){Lt.apply(this,arguments),this._timer=null,this._input=null}function Yt(){Ot.apply(this,arguments)}function Bt(){Ot.apply(this,arguments)}function Ht(){Lt.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function qt(t,e){return(e=e||{}).recognizers=w(e.recognizers,qt.defaults.preset),new Xt(t,e)}Lt.prototype={defaults:{},set:function(t){return o(this.options,t),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(t){if(n(t,"recognizeWith",this))return this;var e=this.simultaneous;return e[(t=Nt(t,this)).id]||(e[t.id]=t).recognizeWith(this),this},dropRecognizeWith:function(t){return n(t,"dropRecognizeWith",this)||(t=Nt(t,this),delete this.simultaneous[t.id]),this},requireFailure:function(t){if(n(t,"requireFailure",this))return this;var e=this.requireFail;return-1===A(e,t=Nt(t,this))&&(e.push(t),t.requireFailure(this)),this},dropRequireFailure:function(t){if(n(t,"dropRequireFailure",this))return this;t=Nt(t,this);var e=A(this.requireFail,t);return-1<e&&this.requireFail.splice(e,1),this},hasRequireFailures:function(){return 0<this.requireFail.length},canRecognizeWith:function(t){return!!this.simultaneous[t.id]},emit:function(e){var i=this,t=this.state;function n(t){i.manager.emit(t,e)}t<8&&n(i.options.event+Rt(t)),n(i.options.event),e.additionalEvent&&n(e.additionalEvent),8<=t&&n(i.options.event+Rt(t))},tryEmit:function(t){if(this.canEmit())return this.emit(t);this.state=32},canEmit:function(){for(var t=0;t<this.requireFail.length;){if(!(this.requireFail[t].state&(32|zt)))return!1;t++}return!0},recognize:function(t){var e=o({},t);if(!T(this.options.enable,[this,e]))return this.reset(),void(this.state=32);56&this.state&&(this.state=zt),this.state=this.process(e),30&this.state&&this.tryEmit(e)},process:function(t){},getTouchAction:function(){},reset:function(){}},g(Ot,Lt,{defaults:{pointers:1},attrTest:function(t){var e=this.options.pointers;return 0===e||t.pointers.length===e},process:function(t){var e=this.state,i=t.eventType,n=6&e,s=this.attrTest(t);return n&&(i&Y||!s)?16|e:n||s?i&F?8|e:2&e?4|e:2:32}}),g(kt,Ot,{defaults:{event:"pan",threshold:10,pointers:1,direction:V},getTouchAction:function(){var t=this.options.direction,e=[];return t&K&&e.push(Pt),t&j&&e.push(It),e},directionTest:function(t){var e=this.options,i=!0,n=t.distance,s=t.direction,r=t.deltaX,o=t.deltaY;return s&e.direction||(n=e.direction&K?(s=0===r?B:r<0?H:q,i=r!=this.pX,Math.abs(t.deltaX)):(s=0===o?B:o<0?X:W,i=o!=this.pY,Math.abs(t.deltaY))),t.direction=s,i&&n>e.threshold&&s&e.direction},attrTest:function(t){return Ot.prototype.attrTest.call(this,t)&&(2&this.state||!(2&this.state)&&this.directionTest(t))},emit:function(t){this.pX=t.deltaX,this.pY=t.deltaY;var e=Dt(t.direction);e&&(t.additionalEvent=this.options.event+e),this._super.emit.call(this,t)}}),g(Gt,Ot,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[At]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.scale-1)>this.options.threshold||2&this.state)},emit:function(t){if(1!==t.scale){var e=t.scale<1?"in":"out";t.additionalEvent=this.options.event+e}this._super.emit.call(this,t)}}),g(Ft,Lt,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return["auto"]},process:function(t){var e=this.options,i=t.pointers.length===e.pointers,n=t.distance<e.threshold,s=t.deltaTime>e.time;if(this._input=t,!n||!i||t.eventType&(F|Y)&&!s)this.reset();else if(t.eventType&G)this.reset(),this._timer=u(function(){this.state=8,this.tryEmit()},e.time,this);else if(t.eventType&F)return 8;return 32},reset:function(){clearTimeout(this._timer)},emit:function(t){8===this.state&&(t&&t.eventType&F?this.manager.emit(this.options.event+"up",t):(this._input.timeStamp=d(),this.manager.emit(this.options.event,this._input)))}}),g(Yt,Ot,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[At]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.rotation)>this.options.threshold||2&this.state)}}),g(Bt,Ot,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:K|j,pointers:1},getTouchAction:function(){return kt.prototype.getTouchAction.call(this)},attrTest:function(t){var e,i=this.options.direction;return i&(K|j)?e=t.overallVelocity:i&K?e=t.overallVelocityX:i&j&&(e=t.overallVelocityY),this._super.attrTest.call(this,t)&&i&t.offsetDirection&&t.distance>this.options.threshold&&t.maxPointers==this.options.pointers&&p(e)>this.options.velocity&&t.eventType&F},emit:function(t){var e=Dt(t.offsetDirection);e&&this.manager.emit(this.options.event+e,t),this.manager.emit(this.options.event,t)}}),g(Ht,Lt,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[St]},process:function(t){var e=this.options,i=t.pointers.length===e.pointers,n=t.distance<e.threshold,s=t.deltaTime<e.time;if(this.reset(),t.eventType&G&&0===this.count)return this.failTimeout();if(n&&s&&i){if(t.eventType!=F)return this.failTimeout();var r=!this.pTime||t.timeStamp-this.pTime<e.interval,o=!this.pCenter||nt(this.pCenter,t.center)<e.posThreshold;if(this.pTime=t.timeStamp,this.pCenter=t.center,o&&r?this.count+=1:this.count=1,this._input=t,0==this.count%e.taps)return this.hasRequireFailures()?(this._timer=u(function(){this.state=8,this.tryEmit()},e.interval,this),2):8}return 32},failTimeout:function(){return this._timer=u(function(){this.state=32},this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),qt.VERSION="2.0.7",qt.defaults={domEvents:!1,touchAction:xt,enable:!0,inputTarget:null,inputClass:null,preset:[[Yt,{enable:!1}],[Gt,{enable:!1},["rotate"]],[Bt,{direction:K}],[kt,{direction:K},["swipe"]],[Ht],[Ht,{event:"doubletap",taps:2},["tap"]],[Ft]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};function Xt(t,e){this.options=o({},qt.defaults,e||{}),this.options.inputTarget=this.options.inputTarget||t,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=t,this.input=function(t){var e=t.options.inputClass;return new(e||(R?dt:D?yt:L?wt:ht))(t,$)}(this),this.touchAction=new Mt(this,this.options.touchAction),Wt(this,!0),c(this.options.recognizers,function(t){var e=this.add(new t[0](t[1]));t[2]&&e.recognizeWith(t[2]),t[3]&&e.requireFailure(t[3])},this)}function Wt(i,n){var s,r=i.element;r.style&&(c(i.options.cssProps,function(t,e){s=_(r.style,e),n?(i.oldCssProps[s]=r.style[s],r.style[s]=t):r.style[s]=i.oldCssProps[s]||""}),n||(i.oldCssProps={}))}Xt.prototype={set:function(t){return o(this.options,t),t.touchAction&&this.touchAction.update(),t.inputTarget&&(this.input.destroy(),this.input.target=t.inputTarget,this.input.init()),this},stop:function(t){this.session.stopped=t?2:1},recognize:function(t){var e=this.session;if(!e.stopped){var i;this.touchAction.preventDefaults(t);var n=this.recognizers,s=e.curRecognizer;(!s||s&&8&s.state)&&(s=e.curRecognizer=null);for(var r=0;r<n.length;)i=n[r],2===e.stopped||s&&i!=s&&!i.canRecognizeWith(s)?i.reset():i.recognize(t),!s&&14&i.state&&(s=e.curRecognizer=i),r++}},get:function(t){if(t instanceof Lt)return t;for(var e=this.recognizers,i=0;i<e.length;i++)if(e[i].options.event==t)return e[i];return null},add:function(t){if(n(t,"add",this))return this;var e=this.get(t.options.event);return e&&this.remove(e),this.recognizers.push(t),(t.manager=this).touchAction.update(),t},remove:function(t){if(n(t,"remove",this))return this;if(t=this.get(t)){var e=this.recognizers,i=A(e,t);-1!==i&&(e.splice(i,1),this.touchAction.update())}return this},on:function(t,e){if(t!==l&&e!==l){var i=this.handlers;return c(S(t),function(t){i[t]=i[t]||[],i[t].push(e)}),this}},off:function(t,e){if(t!==l){var i=this.handlers;return c(S(t),function(t){e?i[t]&&i[t].splice(A(i[t],e),1):delete i[t]}),this}},emit:function(t,e){this.options.domEvents&&function(t,e){var i=s.createEvent("Event");i.initEvent(t,!0,!0),(i.gesture=e).target.dispatchEvent(i)}(t,e);var i=this.handlers[t]&&this.handlers[t].slice();if(i&&i.length){e.type=t,e.preventDefault=function(){e.srcEvent.preventDefault()};for(var n=0;n<i.length;)i[n](e),n++}},destroy:function(){this.element&&Wt(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},o(qt,{INPUT_START:G,INPUT_MOVE:2,INPUT_END:F,INPUT_CANCEL:Y,STATE_POSSIBLE:zt,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:32,DIRECTION_NONE:B,DIRECTION_LEFT:H,DIRECTION_RIGHT:q,DIRECTION_UP:X,DIRECTION_DOWN:W,DIRECTION_HORIZONTAL:K,DIRECTION_VERTICAL:j,DIRECTION_ALL:V,Manager:Xt,Input:J,TouchAction:Mt,TouchInput:yt,MouseInput:ht,PointerEventInput:dt,TouchMouseInput:wt,SingleTouchInput:mt,Recognizer:Lt,AttrRecognizer:Ot,Tap:Ht,Pan:kt,Swipe:Bt,Pinch:Gt,Rotate:Yt,Press:Ft,on:E,off:C,each:c,merge:v,extend:m,assign:o,inherit:g,bindFn:y,prefixed:_}),(void 0!==r?r:"undefined"!=typeof self?self:{}).Hammer=qt,void 0!==Kt&&Kt.exports?Kt.exports=qt:r.Hammer=qt}(window,document)},{}],2:[function(t,e,i){"use strict";var n=t("./grid"),c=t("./tile");function s(t,e,i,n){this.config=n,this.size=n.size,this.storageManager=new i,this.view=new e(n.strings),this.inputManager=new t,this.startTiles=2,this.inputManager.bindGameContainer(this.view.gameContainer),this.inputManager.bindRestartButton(this.view.restartButton),this.inputManager.bindRestartButton(this.view.retryButton),this.inputManager.bindKeepPlayingButton(this.view.keepPlayingButton),this.inputManager.on("move",this.move.bind(this)),this.inputManager.on("restart",this.restart.bind(this)),this.inputManager.on("keepPlaying",this.keepPlaying.bind(this)),this.helpTimeout=null,this.setup(),this.view.blinkHelp()}s.prototype.getElement=function(){return this.view.element},s.prototype.restart=function(){this.config.persistGameState&&this.storageManager.clearGameState(),this.view.continueGame(),this.setup(),this.view.blinkHelp()},s.prototype.keepPlaying=function(){this.keepPlaying=!0,this.view.continueGame()},s.prototype.isGameTerminated=function(){return this.over||this.won&&!this.keepPlaying},s.prototype.setup=function(){var t=null;this.config.persistGameState&&(t=this.storageManager.getGameState()),t?(this.grid=new n(t.grid.size,t.grid.cells),this.score=t.score,this.over=t.over,this.won=t.won,this.keepPlaying=t.keepPlaying):(this.grid=new n(this.size),this.score=0,this.over=!1,this.won=!1,this.keepPlaying=!1,this.addStartTiles()),this.actuate()},s.prototype.addStartTiles=function(){for(var t=0;t<this.startTiles;t++)this.addRandomTile()},s.prototype.addRandomTile=function(){if(this.grid.cellsAvailable()){var t=Math.random()<.9?2:4,e=new c(this.grid.randomAvailableCell(),t);this.grid.insertTile(e)}},s.prototype.actuate=function(){this.storageManager.getBestScore()<this.score&&this.storageManager.setBestScore(this.score),this.config.persistGameState&&(this.over?this.storageManager.clearGameState():this.storageManager.setGameState(this.serialize())),this.view.actuate(this.grid,{score:this.score,over:this.over,won:this.won,bestScore:this.storageManager.getBestScore(),terminated:this.isGameTerminated()})},s.prototype.serialize=function(){return{grid:this.grid.serialize(),score:this.score,over:this.over,won:this.won,keepPlaying:this.keepPlaying}},s.prototype.prepareTiles=function(){this.grid.eachCell(function(t,e,i){i&&(i.mergedFrom=null,i.savePosition())})},s.prototype.moveTile=function(t,e){this.grid.cells[t.x][t.y]=null,(this.grid.cells[e.x][e.y]=t).updatePosition(e)},s.prototype.move=function(t){var r=this;if(!this.isGameTerminated()){var o,a,h=this.getVector(t),e=this.buildTraversals(h),u=!1;this.prepareTiles(),e.x.forEach(function(s){e.y.forEach(function(t){if(o={x:s,y:t},a=r.grid.cellContent(o)){var e=r.findFarthestPosition(o,h),i=r.grid.cellContent(e.next);if(i&&i.value===a.value&&!i.mergedFrom){var n=new c(e.next,2*a.value);n.mergedFrom=[a,i],r.grid.insertTile(n),r.grid.removeTile(a),a.updatePosition(e.next),r.score+=n.value,2048===n.value&&(r.won=!0)}else r.moveTile(a,e.farthest);r.positionsEqual(o,a)||(u=!0)}})}),u&&(this.addRandomTile(),this.movesAvailable()||(this.over=!0),this.actuate())}},s.prototype.getVector=function(t){return{0:{x:0,y:-1},1:{x:1,y:0},2:{x:0,y:1},3:{x:-1,y:0}}[t]},s.prototype.buildTraversals=function(t){for(var e={x:[],y:[]},i=0;i<this.size;i++)e.x.push(i),e.y.push(i);return 1===t.x&&(e.x=e.x.reverse()),1===t.y&&(e.y=e.y.reverse()),e},s.prototype.findFarthestPosition=function(t,e){for(var i;t={x:(i=t).x+e.x,y:i.y+e.y},this.grid.withinBounds(t)&&this.grid.cellAvailable(t););return{farthest:i,next:t}},s.prototype.movesAvailable=function(){return this.grid.cellsAvailable()||this.tileMatchesAvailable()},s.prototype.tileMatchesAvailable=function(){for(var t,e=0;e<this.size;e++)for(var i=0;i<this.size;i++)if(t=this.grid.cellContent({x:e,y:i}))for(var n=0;n<4;n++){var s=this.getVector(n),r={x:e+s.x,y:i+s.y},o=this.grid.cellContent(r);if(o&&o.value===t.value)return!0}return!1},s.prototype.positionsEqual=function(t,e){return t.x===e.x&&t.y===e.y},s.prototype.pause=function(){this.view.pause()},s.prototype.resume=function(){this.view.resume()},e.exports=s},{"./grid":3,"./tile":12}],3:[function(t,e,i){"use strict";var o=t("./tile");function n(t,e){this.size=t,this.cells=e?this.fromState(e):this.empty()}n.prototype.empty=function(){for(var t=[],e=0;e<this.size;e++)for(var i=t[e]=[],n=0;n<this.size;n++)i.push(null);return t},n.prototype.fromState=function(t){for(var e=[],i=0;i<this.size;i++)for(var n=e[i]=[],s=0;s<this.size;s++){var r=t[i][s];n.push(r?new o(r.position,r.value):null)}return e},n.prototype.randomAvailableCell=function(){var t=this.availableCells();if(t.length)return t[Math.floor(Math.random()*t.length)]},n.prototype.availableCells=function(){var n=[];return this.eachCell(function(t,e,i){i||n.push({x:t,y:e})}),n},n.prototype.eachCell=function(t){for(var e=0;e<this.size;e++)for(var i=0;i<this.size;i++)t(e,i,this.cells[e][i])},n.prototype.cellsAvailable=function(){return!!this.availableCells().length},n.prototype.cellAvailable=function(t){return!this.cellOccupied(t)},n.prototype.cellOccupied=function(t){return!!this.cellContent(t)},n.prototype.cellContent=function(t){return this.withinBounds(t)?this.cells[t.x][t.y]:null},n.prototype.insertTile=function(t){this.cells[t.x][t.y]=t},n.prototype.removeTile=function(t){this.cells[t.x][t.y]=null},n.prototype.withinBounds=function(t){return 0<=t.x&&t.x<this.size&&0<=t.y&&t.y<this.size},n.prototype.serialize=function(){for(var t=[],e=0;e<this.size;e++)for(var i=t[e]=[],n=0;n<this.size;n++)i.push(this.cells[e][n]?this.cells[e][n].serialize():null);return{size:this.size,cells:t}},e.exports=n},{"./tile":12}],4:[function(t,e,i){"use strict";function n(t){this.strings=t,this.element=document.createElement("div"),this.element.classList.add("game2048"),this.container=document.createElement("div"),this.container.classList.add("container"),this.element.append(this.container),this.gameContainer=document.createElement("div"),this.gameContainer.classList.add("game-container"),this.container.append(this.gameContainer),this.messageContainer=document.createElement("div"),this.messageContainer.classList.add("game-message"),this.messageContainerParagraph=document.createElement("p"),this.messageContainer.append(this.messageContainerParagraph),this.gameContainer.append(this.messageContainer);var e=document.createElement("div");e.classList.add("lower"),this.messageContainer.append(e),this.keepPlayingButton=document.createElement("a"),this.keepPlayingButton.classList.add("keep-playing-button"),this.keepPlayingButton.textContent=this.strings.KEEP_GOING,e.append(this.keepPlayingButton),this.retryButton=document.createElement("a"),this.retryButton.classList.add("retry-button"),this.retryButton.textContent=this.strings.TRY_AGAIN,e.append(this.retryButton),this.messageContainer.append(e);var i=document.createElement("div");i.classList.add("grid-container");for(var n=0;4!==n;n+=1){var s=document.createElement("div");s.classList.add("grid-row"),i.append(s);for(var r=0;4!==r;r+=1){var o=document.createElement("div");o.classList.add("grid-cell"),s.append(o)}}this.gameContainer.append(i),this.tileContainer=document.createElement("div"),this.tileContainer.classList.add("tile-container"),this.gameContainer.append(this.tileContainer),this.restartButton=document.createElement("a"),this.restartButton.classList.add("restart-button"),this.restartButton.textContent=this.strings.NEW_GAME,this.container.append(this.restartButton);var a=document.createElement("div");a.classList.add("score-wrapper"),a.classList.add("score-wrapper-score");var h=document.createElement("div");h.classList.add("label"),h.textContent=this.strings.SCORE,a.append(h),this.scoreContainer=document.createElement("div"),this.scoreContainer.classList.add("score-container"),this.scoreContainer.textContent="0",a.append(this.scoreContainer),this.container.append(a);var u=document.createElement("div");u.classList.add("score-wrapper"),u.classList.add("score-wrapper-best");var c=document.createElement("div");c.classList.add("label"),c.textContent=this.strings.HIGH_SCORE,u.append(c),this.bestContainer=document.createElement("div"),this.bestContainer.classList.add("best-container"),this.bestContainer.textContent="0",u.append(this.bestContainer),this.container.append(u),this.helpText=document.createElement("div"),this.helpText.classList.add("helping-text"),this.helpText.textContent=this.strings.HELP_TEXT,this.container.append(this.helpText),this.helpHand=document.createElement("div"),this.helpHand.classList.add("helping-hand"),this.container.append(this.helpHand),this.helpTimeout=null,this.score=0}n.prototype.actuate=function(t,e){var i=this;window.requestAnimationFrame(function(){i.clearContainer(i.tileContainer),t.cells.forEach(function(t){t.forEach(function(t){t&&i.addTile(t)})}),i.updateScore(e.score),i.updateBestScore(e.bestScore),e.terminated&&(e.over?i.message(!1):e.won&&i.message(!0))})},n.prototype.continueGame=function(){this.clearMessage()},n.prototype.clearContainer=function(t){for(;t.firstChild;)t.removeChild(t.firstChild)},n.prototype.addTile=function(t){var e=this,i=document.createElement("div"),n=document.createElement("div"),s=t.previousPosition||{x:t.x,y:t.y},r=this.positionClass(s),o=["tile","tile-"+t.value,r];2048<t.value&&o.push("tile-super"),this.applyClasses(i,o),n.classList.add("tile-inner"),n.textContent=t.value,t.previousPosition?window.requestAnimationFrame(function(){o[2]=e.positionClass({x:t.x,y:t.y}),e.applyClasses(i,o)}):t.mergedFrom?(o.push("tile-merged"),this.applyClasses(i,o),t.mergedFrom.forEach(function(t){e.addTile(t)})):(o.push("tile-new"),this.applyClasses(i,o)),i.appendChild(n),this.tileContainer.appendChild(i)},n.prototype.applyClasses=function(t,e){t.setAttribute("class",e.join(" "))},n.prototype.normalizePosition=function(t){return{x:t.x+1,y:t.y+1}},n.prototype.positionClass=function(t){return"tile-position-"+(t=this.normalizePosition(t)).x+"-"+t.y},n.prototype.updateScore=function(t){this.clearContainer(this.scoreContainer);var e=t-this.score;if(this.score=t,this.scoreContainer.textContent=this.score,0<e){var i=document.createElement("div");i.classList.add("score-addition"),i.textContent="+"+e,this.scoreContainer.appendChild(i)}},n.prototype.updateBestScore=function(t){this.bestContainer.textContent=t},n.prototype.message=function(t){var e=t?"game-won":"game-over",i=t?this.strings.YOU_WIN:this.strings.GAME_OVER;this.messageContainer.classList.add(e),this.messageContainerParagraph.textContent=i},n.prototype.clearMessage=function(){this.messageContainer.classList.remove("game-won"),this.messageContainer.classList.remove("game-over")},n.prototype.showHelp=function(){window.setTimeout(function(){this.helpHand.classList.add("shown"),this.helpText.classList.add("shown")}.bind(this),0)},n.prototype.hideHelp=function(){null!==this.helpTimeout&&(window.clearTimeout(this.helpTimeout),this.helpTimeout=null),this.helpHand.classList.remove("shown"),this.helpText.classList.remove("shown")},n.prototype.blinkHelp=function(){this.hideHelp(),this.helpTimeout=window.setTimeout(this.hideHelp.bind(this),6e3),this.showHelp()},n.prototype.pause=function(){this.element.classList.add("paused")},n.prototype.resume=function(){this.element.classList.remove("paused")},e.exports=n},{}],5:[function(t,e,i){"use strict";var n=t("hammerjs");function s(){this.events={}}s.prototype.on=function(t,e){this.events[t]||(this.events[t]=[]),this.events[t].push(e)},s.prototype.emit=function(t,e){var i=this.events[t];i&&i.forEach(function(t){t(e)})},s.prototype.bindKeyboard=function(){var n=this,s={38:0,39:1,40:2,37:3,75:0,76:1,74:2,72:3,87:0,68:1,83:2,65:3};document.addEventListener("keydown",function(t){var e=t.altKey||t.ctrlKey||t.metaKey||t.shiftKey,i=s[t.which];e||void 0!==i&&(t.preventDefault(),n.emit("move",i)),e||82!==t.which||n.restart.call(n,t)})},s.prototype.bindGameContainer=function(t){var e=this,i=new n.Manager(t);i.add(new n.Swipe),i.on("swiperight",function(){return e.emit("move",1)}),i.on("swipeleft",function(){return e.emit("move",3)}),i.on("swipeup",function(){return e.emit("move",0)}),i.on("swipedown",function(){return e.emit("move",2)})},s.prototype.bindRestartButton=function(t){this.bindButtonPress(t,this.restart)},s.prototype.bindKeepPlayingButton=function(t){this.bindButtonPress(t,this.keepPlaying)},s.prototype.restart=function(t){t.preventDefault(),this.emit("restart")},s.prototype.keepPlaying=function(t){t.preventDefault(),this.emit("keepPlaying")},s.prototype.bindButtonPress=function(t,e){t.addEventListener("click",e.bind(this)),t.addEventListener(this.eventTouchend,e.bind(this))},e.exports=s},{hammerjs:1}],6:[function(t,e,i){"use strict";function n(){this.bestScoreKey="IMAGINARY.game2048.bestScore",this.bestScoreDateKey="IMAGINARY.game2048.bestScoreDate",this.gameStateKey="IMAGINARY.game2048.gameState";var t=this.localStorageSupported();this.storage=t?window.localStorage:window.IMAGINARY.game2048.fakeStorage}void 0===window.IMAGINARY&&(window.IMAGINARY={}),void 0===window.IMAGINARY.game2048&&(window.IMAGINARY.game2048={}),window.IMAGINARY.game2048.fakeStorage={_data:{},setItem:function(t,e){return this._data[t]=String(e)},getItem:function(t){return this._data.hasOwnProperty(t)?this._data[t]:void 0},removeItem:function(t){return delete this._data[t]},clear:function(){return this._data={}}},n.prototype.localStorageSupported=function(){try{var t=window.localStorage;return t.setItem("test","1"),t.removeItem("test"),!0}catch(t){return!1}},n.prototype.getCurrentDate=function(){function t(t){return t.toString().padStart(2,"0")}var e=new Date;return[e.getFullYear(),t(e.getMonth()+1),t(e.getDate())].join("-")},n.prototype.getBestScore=function(){return this.storage.getItem(this.bestScoreDateKey)===this.getCurrentDate()&&this.storage.getItem(this.bestScoreKey)||0},n.prototype.setBestScore=function(t){this.storage.setItem(this.bestScoreDateKey,this.getCurrentDate()),this.storage.setItem(this.bestScoreKey,t)},n.prototype.getGameState=function(){var t=this.storage.getItem(this.gameStateKey);return t?JSON.parse(t):null},n.prototype.setGameState=function(t){this.storage.setItem(this.gameStateKey,JSON.stringify(t))},n.prototype.clearGameState=function(){this.storage.removeItem(this.gameStateKey)},e.exports=n},{}],7:[function(t,e,i){"use strict";function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}t("./polyfills/bind_polyfill"),t("./polyfills/classlist_polyfill"),t("./polyfills/animframe_polyfill");var s=t("./game_manager"),r=t("./input_manager"),o=t("./html_view"),a=t("./local_storage_manager"),h=t("./strings_de.json"),u=function(){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var t={size:4,persistGameState:!1,strings:h};this.gameManager=new s(r,o,a,t)}return function(t,e,i){e&&n(t.prototype,e),i&&n(t,i)}(e,[{key:"pause",value:function(){this.gameManager.pause()}},{key:"resume",value:function(){this.gameManager.resume()}},{key:"reset",value:function(){this.gameManager.restart()}},{key:"domElement",get:function(){return this.gameManager.getElement()}}]),e}();e.exports=u},{"./game_manager":2,"./html_view":4,"./input_manager":5,"./local_storage_manager":6,"./polyfills/animframe_polyfill":8,"./polyfills/bind_polyfill":9,"./polyfills/classlist_polyfill":10,"./strings_de.json":11}],8:[function(t,e,i){"use strict";!function(){for(var s=0,t=["webkit","moz"],e=0;e<t.length&&!window.requestAnimationFrame;++e)window.requestAnimationFrame=window[t[e]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[e]+"CancelAnimationFrame"]||window[t[e]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t){var e=(new Date).getTime(),i=Math.max(0,16-(e-s)),n=window.setTimeout(function(){t(e+i)},i);return s=e+i,n}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)})}()},{}],9:[function(t,e,i){"use strict";Function.prototype.bind=Function.prototype.bind||function(e){var i=this;return function(t){t instanceof Array||(t=[t]),i.apply(e,t)}}},{}],10:[function(t,e,i){"use strict";!function(){if(!(void 0===window.Element||"classList"in document.documentElement)){var t,e,i,n=Array.prototype,s=n.push,r=n.splice,o=n.join;a.prototype={add:function(t){this.contains(t)||(s.call(this,t),this.el.className=this.toString())},contains:function(t){return-1!=this.el.className.indexOf(t)},item:function(t){return this[t]||null},remove:function(t){if(this.contains(t)){for(var e=0;e<this.length&&this[e]!=t;e++);r.call(this,e,1),this.el.className=this.toString()}},toString:function(){return o.call(this," ")},toggle:function(t){return this.contains(t)?this.remove(t):this.add(t),this.contains(t)}},window.DOMTokenList=a,t=HTMLElement.prototype,e="classList",i=function(){return new a(this)},Object.defineProperty?Object.defineProperty(t,e,{get:i}):t.__defineGetter__(e,i)}function a(t){for(var e=(this.el=t).className.replace(/^\s+|\s+$/g,"").split(/\s+/),i=0;i<e.length;i++)s.call(this,e[i])}}()},{}],11:[function(t,e,i){e.exports={KEEP_GOING:"Mach weiter",TRY_AGAIN:"Nochmal versuchen",NEW_GAME:"Neues Spiel",SCORE:"Punkte",HIGH_SCORE:"Tagesrekord",HELP_TEXT:"Wische über das Spielfeld, um Kacheln mit demselben Symbol zu verschmelzen.",YOU_WIN:"Gewonnen!",GAME_OVER:"Game over!"}},{}],12:[function(t,e,i){"use strict";function n(t,e){this.x=t.x,this.y=t.y,this.value=e||2,this.previousPosition=null,this.mergedFrom=null}n.prototype.savePosition=function(){this.previousPosition={x:this.x,y:this.y}},n.prototype.updatePosition=function(t){this.x=t.x,this.y=t.y},n.prototype.serialize=function(){return{position:{x:this.x,y:this.y},value:this.value}},e.exports=n},{}]},{},[7])(7)});
//# sourceMappingURL=game2048.min.js.map
